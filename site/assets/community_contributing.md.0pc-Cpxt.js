import{_ as p,C as d,c,o as i,j as s,b as o,a7 as h,a,w as t,G as l,a8 as r}from"./chunks/framework.odPblmUY.js";const F=JSON.parse('{"title":"Mermaid Contributing Guide","description":"","frontmatter":{"editLink":"https://github.com/mermaid-js/mermaid/edit/develop/packages/mermaid/src/docs/community/contributing.md","head":[["link",{"rel":"canonical","href":"https://mermaid.ai/open-source/community/contributing.html"}]]},"headers":[],"relativePath":"community/contributing.md","filePath":"community/contributing.md"}'),k={name:"community/contributing.md"};function g(u,e,m,b,y,v){const n=d("Mermaid");return i(),c("div",null,[e[5]||(e[5]=s("h1",{id:"mermaid-contributing-guide",tabindex:"-1"},[a("Mermaid Contributing Guide "),s("a",{class:"header-anchor",href:"#mermaid-contributing-guide","aria-label":'Permalink to "Mermaid Contributing Guide"'},"​")],-1)),e[6]||(e[6]=s("p",null,"You decided to take part in the development? Welcome!",-1)),e[7]||(e[7]=s("p",null,"We are trying to make our guidelines for you as explicit and detailed as possible.",-1)),e[8]||(e[8]=s("h2",{id:"initial-setup",tabindex:"-1"},[a("Initial Setup "),s("a",{class:"header-anchor",href:"#initial-setup","aria-label":'Permalink to "Initial Setup"'},"​")],-1)),e[9]||(e[9]=s("p",null,"Initial setup consists of 3 main steps:",-1)),(i(),o(r,null,{default:t(()=>[l(n,{id:"mermaid-15",showCode:!1,graph:"flowchart%20LR%0A%20%20source%20--%3E%20requirements%20--%3E%20setup%0A%0A%20%20source%5BGet%20the%20Source%20Code%5D%0A%20%20requirements%5BInstall%20the%20Requirements%5D%0A%20%20setup%5BInstall%20Packages%5D%0A"})]),fallback:t(()=>[...e[0]||(e[0]=[a(" Loading... ",-1)])]),_:1})),e[10]||(e[10]=h(`<h3 id="get-the-source-code" tabindex="-1">Get the Source Code <a class="header-anchor" href="#get-the-source-code" aria-label="Permalink to &quot;Get the Source Code&quot;">​</a></h3><p>In GitHub, you first <a href="https://github.com/mermaid-js/mermaid/fork" target="_blank" rel="noreferrer"><strong>fork a mermaid repository</strong></a> when you are going to make changes and submit pull requests.</p><p>Then you <strong>clone</strong> a copy to your local development machine (e.g. where you code) to make a copy with all the files to work with.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><a href="https://docs.github.com/en/get-started/quickstart/fork-a-repo" target="_blank" rel="noreferrer">Here is a GitHub document that gives an overview of the process</a>.</p></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git@github.com/your-fork/mermaid</span></span></code></pre></div><p>Once you have cloned the repository onto your development machine, change into the <code>mermaid</code> project folder (the top level directory of the mermaid project repository)</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mermaid</span></span></code></pre></div><h3 id="install-requirements" tabindex="-1">Install Requirements <a class="header-anchor" href="#install-requirements" aria-label="Permalink to &quot;Install Requirements&quot;">​</a></h3><p>We support <strong>development within Docker</strong> environment along with <strong>host setup</strong>. You may choose it up to your preferences.</p><p><strong>Host</strong></p><p>These are the tools we use for working with the code and documentation:</p><ul><li><a href="https://nodejs.org/en/" target="_blank" rel="noreferrer">Node.js</a>.</li><li><a href="https://pnpm.io/" target="_blank" rel="noreferrer">pnpm</a> package manager.</li></ul><p>The following commands must be sufficient enough to start with:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -fsSL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://get.pnpm.io/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> env</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --global</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span></span></code></pre></div><p>You may also need to reload <code>.shrc</code> or <code>.bashrc</code> afterwards.</p><p><strong>Docker</strong></p><p><a href="https://docs.docker.com/engine/install/" target="_blank" rel="noreferrer">Install Docker</a>. And that is pretty much all you need.</p><p>Optionally, to run GUI (Cypress) within Docker you will also need an X11 server installed. You might already have it installed, so check this by running:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DISPLAY</span></span></code></pre></div><p>If the <code>$DISPLAY</code> variable is not empty, then an X11 server is running. Otherwise you may need to install one.</p><h3 id="install-packages" tabindex="-1">Install Packages <a class="header-anchor" href="#install-packages" aria-label="Permalink to &quot;Install Packages&quot;">​</a></h3><p><strong>Host</strong></p><p>Install packages:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span></code></pre></div><p><strong>Docker</strong></p><p>For development using Docker there is a self-documented <code>run</code> bash script, which provides convenient aliases for <code>docker compose</code> commands.</p><p>Make sure that <code>./run</code> script is executable:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>To get detailed help simply type <code>./run</code> or <code>./run help</code>.</p><p>It also has short <em>Development quick start guide</em> embedded.</p></div><p>Then install packages:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span></code></pre></div><h3 id="verify-everything-works" tabindex="-1">Verify Everything Works <a class="header-anchor" href="#verify-everything-works" aria-label="Permalink to &quot;Verify Everything Works&quot;">​</a></h3><p>This step is optional, but it helps to make sure that everything in development branch was OK before you started making any changes.</p><p>You can run the <code>test</code> script to verify that pnpm is working <em>and</em> that the repository has been cloned correctly:</p><p><strong>Host</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span></code></pre></div><p><strong>Docker</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span></code></pre></div><p>The <code>test</code> script and others are in the top-level <code>package.json</code> file.</p><p>All tests should run successfully without any errors or failures.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>You might see <em>lint</em> or <em>formatting</em> warnings. Those are ok during this step.</p></div><h2 id="workflow" tabindex="-1">Workflow <a class="header-anchor" href="#workflow" aria-label="Permalink to &quot;Workflow&quot;">​</a></h2><p>Contributing process is very simple and straightforward:</p>`,43)),(i(),o(r,null,{default:t(()=>[l(n,{id:"mermaid-145",showCode:!1,graph:"%20%20flowchart%20LR%0A%0A%20%20branch%20--%3E%20changes%20--%3E%20submit%0A%20%20branch%5BCheckout%20a%20New%20Branch%5D%0A%20%20changes%5BMake%20Changes%5D%0A%20%20submit%5BSubmit%20a%20PR%5D%0A"})]),fallback:t(()=>[...e[1]||(e[1]=[a(" Loading... ",-1)])]),_:1})),e[11]||(e[11]=s("p",null,[a("Mermaid uses a "),s("a",{href:"https://guides.github.com/introduction/flow/",target:"_blank",rel:"noreferrer"},"Git Flow"),a("–inspired approach to branching.")],-1)),e[12]||(e[12]=s("p",null,[a("Development is done in the "),s("code",null,"develop"),a(" branch.")],-1)),(i(),o(r,null,{default:t(()=>[l(n,{id:"mermaid-152",showCode:!1,graph:"---%0Aconfig%3A%0A%20%20gitGraph%3A%0A%20%20%20%20mainBranchName%3A%20develop%0A---%0AgitGraph%20LR%3A%0A%20%20commit%0A%20%20commit%0A%20%20branch%20%22docs%2F2910_update-guidelines%22%20order%3A%201%0A%20%20commit%0A%20%20commit%0A%20%20commit%0A%20%20checkout%20develop%0A%20%20merge%20%22docs%2F2910_update-guidelines%22%0A%20%20commit%0A"})]),fallback:t(()=>[...e[2]||(e[2]=[a(" Loading... ",-1)])]),_:1})),e[13]||(e[13]=h('<p>To prepare a new version for release the maintainers create a <code>release/vX.X.X</code> branch from <code>develop</code> for testing. Once the release happens we add a tag to the <code>release</code> branch and merge it with <code>master</code>. The live product and on-line documentation are what is in the <code>master</code> branch.</p><h2 id="checkout-a-new-branch" tabindex="-1">Checkout a New Branch <a class="header-anchor" href="#checkout-a-new-branch" aria-label="Permalink to &quot;Checkout a New Branch&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>All new work should be based on the <code>develop</code> branch.</p></div><p>Make sure you have the most up-to-date version of the <code>develop</code> branch.</p><p>Check out the <code>develop</code> branch, then <code>fetch</code> or <code>pull</code> to update it:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> develop</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fetch</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # or `git pull`</span></span></code></pre></div><p>Create a new branch for your work:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkout</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docs/2910_update-contributing-guidelines</span></span></code></pre></div><p>We use the following naming convention for branches:</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[feature | bug | chore | docs]/[issue number]_[short-description]</span></span></code></pre></div><p>You can always check current <a href="https://github.com/mermaid-js/mermaid/blob/develop/.github/pr-labeler.yml" target="_blank" rel="noreferrer">configuration of labelling and branch prefixes</a></p><ul><li>The first part is the <strong>type</strong> of change: a <code>feature</code>, <code>bug</code>, <code>chore</code>, <code>docs</code></li><li>followed by a <strong>slash</strong> (<code>/</code>),which helps to group like types together in many git tools</li><li>followed by the <strong>issue number</strong>, e.g. <code>2910</code></li><li>followed by an <strong>underscore</strong> (<code>_</code>)</li><li>followed by a <strong>short description</strong> with dashes (<code>-</code>) or underscores (<code>_</code>) instead of spaces</li></ul>',12)),(i(),o(r,null,{default:t(()=>[l(n,{id:"mermaid-209",showCode:!1,graph:"flowchart%20LR%0A%20%20feature%20--%3E%20slash%0A%20%20bug%20--%3E%20slash%0A%20%20chore%20--%3E%20slash%0A%20%20docs%20--%3E%20slash%0A%20%20slash%20--%3E%202945%20--%3E%20underscore%0A%20%20slash%20--%3E%201123%20--%3E%20underscore%0A%20%20underscore%20--%3E%20short_description_1%0A%20%20underscore%20--%3E%20short_description_2%0A%0A%20%20underscore%5B%22_%22%5D%0A%20%20slash%5B%22%2F%22%5D%0A%0A%20%20short_description_1%5B%22state-diagram-new-arrow-florbs%22%5D%0A%20%20short_description_2%5B%22fix_random_ugly_red_text%22%5D%0A"})]),fallback:t(()=>[...e[3]||(e[3]=[a(" Loading... ",-1)])]),_:1})),e[14]||(e[14]=h(`<p>If your work is specific to a single diagram type, it is a good idea to put the diagram type at the start of the description. This will help us keep release notes organized by a diagram type.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>A new feature described in issue 2945 that adds a new arrow type called &#39;florbs&#39; to state diagrams</p><p><code>feature/2945_state-diagram-new-arrow-florbs</code></p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>A bug described in issue 1123 that causes random ugly red text in multiple diagram types</p><p><code>bug/1123_fix_random_ugly_red_text</code></p></div><h2 id="contributing-code" tabindex="-1">Contributing Code <a class="header-anchor" href="#contributing-code" aria-label="Permalink to &quot;Contributing Code&quot;">​</a></h2><p>Code is the heart of every software project. We strive to make it better. Who if not us?</p><h3 id="where-is-the-code-located" tabindex="-1">Where is the Code Located? <a class="header-anchor" href="#where-is-the-code-located" aria-label="Permalink to &quot;Where is the Code Located?&quot;">​</a></h3><p>The core of Mermaid is located under <code>packages/mermaid/src</code>.</p><h3 id="building-mermaid-locally" tabindex="-1">Building Mermaid Locally <a class="header-anchor" href="#building-mermaid-locally" aria-label="Permalink to &quot;Building Mermaid Locally&quot;">​</a></h3><p><strong>Host</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><p><strong>Docker</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><p>This will build the Mermaid library and the documentation site.</p><h3 id="running-mermaid-locally" tabindex="-1">Running Mermaid Locally <a class="header-anchor" href="#running-mermaid-locally" aria-label="Permalink to &quot;Running Mermaid Locally&quot;">​</a></h3><p><strong>Host</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre></div><p><strong>Docker</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre></div><p>After starting the dev server open <a href="http://localhost:9000" target="_blank" rel="noreferrer">http://localhost:9000</a> in your browser.</p><p>Now you are ready to make your changes!</p><h3 id="make-changes" tabindex="-1">Make Changes <a class="header-anchor" href="#make-changes" aria-label="Permalink to &quot;Make Changes&quot;">​</a></h3><p>Have a look at <a href="http://localhost:9000" target="_blank" rel="noreferrer">http://localhost:9000</a>. There is a list of demos that can be used to see and test your changes.</p><p>If you need a specific diagram, you can duplicate the <code>example.html</code> file in <code>/demos/dev</code> and add your own mermaid code to your copy.</p><p>That will be served at <a href="http://localhost:9000/dev/your-file-name.html" target="_blank" rel="noreferrer">http://localhost:9000/dev/your-file-name.html</a>. After making code changes, the dev server will rebuild the mermaid library and automatically reload the page.</p><p>Edit files in <code>packages/mermaid/src</code> as required.</p><h3 id="write-tests" tabindex="-1">Write Tests <a class="header-anchor" href="#write-tests" aria-label="Permalink to &quot;Write Tests&quot;">​</a></h3><p>Tests ensure that each function, module, or part of code does what it says it will do. This is critically important when other changes are made to ensure that existing code is not broken (no regression).</p><p>Just as important, the tests act as <em>specifications:</em> they specify what the code does (or should do). Whenever someone is new to a section of code, they should be able to read the tests to get a thorough understanding of what it does and why.</p><p>If you are fixing a bug, you should add tests to ensure that your code has actually fixed the bug, to specify/describe what the code is doing, and to ensure the bug doesn&#39;t happen again. (If there had been a test for the situation, the bug never would have happened in the first place.) You may need to change existing tests if they were inaccurate.</p><p>If you are adding a feature, you will definitely need to add tests. Depending on the size of your feature, you may need to add integration tests.</p><h4 id="unit-tests" tabindex="-1">Unit Tests <a class="header-anchor" href="#unit-tests" aria-label="Permalink to &quot;Unit Tests&quot;">​</a></h4><p>Unit tests are tests that test a single function or module. They are the easiest to write and the fastest to run.</p><p>Unit tests are mandatory for all code except the layout tests. (The layouts are tested with integration tests.)</p><p>We use <a href="https://vitest.dev" target="_blank" rel="noreferrer">Vitest</a> to run unit tests.</p><p><strong>Host</strong></p><p>You can use the following command to run the unit tests:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span></code></pre></div><p>When writing new tests, it&#39;s easier to have the tests automatically run as you make changes. You can do this by running the following command:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test:watch</span></span></code></pre></div><p><strong>Docker</strong></p><p>When using Docker prepend your command with <code>./run</code>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span></code></pre></div><h5 id="testing-the-dom" tabindex="-1">Testing the DOM <a class="header-anchor" href="#testing-the-dom" aria-label="Permalink to &quot;Testing the DOM&quot;">​</a></h5><p>One can use <code>jsdomIt</code> to test any part of Mermaid that interacts with the DOM, as long as it is not related to the layout.</p><p>The function <code>jsdomIt</code> (<a href="../../tests/util.ts">developed in utils.ts</a>) overrides <code>it</code> from <code>vitest</code>, and creates a pseudo-browser environment that works almost like the real deal for the duration of the test. It uses JSDOM to create a DOM, and adds objects <code>window</code> and <code>document</code> to <code>global</code> to mock the browser environment.</p><blockquote><p>[!NOTE] The layout cannot work in <code>jsdomIt</code> tests because JSDOM has no rendering engine, hence the pseudo-browser environment.</p></blockquote><p>Example :</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ensureNodeFromSelector, jsdomIt } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./tests/util.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">jsdomIt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;should add element &quot;thing&quot; in the SVG&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">svg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Code in this block runs in a pseudo-browser environment</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  addThing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(svg); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// The svg item is the D3 selection of the SVG node</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> svgNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ensureNodeFromSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;svg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Retrieve the DOM node using the DOM API</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(svgNode.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">querySelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;thing&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)).not.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toBeNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Test the structure of the SVG</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>They can be used to test any method that interacts with the DOM, including for testing renderers. For renderers, additional integration testing is necessary to test the layout though.</p><h4 id="integration-end-to-end-e2e-tests" tabindex="-1">Integration / End-to-End (E2E) Tests <a class="header-anchor" href="#integration-end-to-end-e2e-tests" aria-label="Permalink to &quot;Integration / End-to-End (E2E) Tests&quot;">​</a></h4><p>These test the rendering and visual appearance of the diagrams.</p><p>This ensures that the rendering of that feature in the E2E will be reviewed in the release process going forward. Less chance that it breaks!</p><p>To start working with the E2E tests:</p><p><strong>Host</strong></p><ul><li>Run <code>pnpm dev</code> to start the dev server</li><li>Start <strong>Cypress</strong> by running <code>pnpm cypress:open</code></li></ul><p><strong>Docker</strong></p><ul><li>Enable local connections for x11 server <code>xhost +local:</code></li><li>Run <code>./run pnpm dev</code> to start the dev server</li><li>Start <strong>Cypress</strong> by running <code>./run pnpm cypress:open --project .</code></li></ul><p>The rendering tests are very straightforward to create. There is a function <code>imgSnapshotTest</code>, which takes a diagram in text form and the mermaid options, and it renders that diagram in Cypress.</p><p>When running in CI it will take a snapshot of the rendered diagram and compare it with the snapshot from last build and flag it for review if it differs.</p><p>This is what a rendering test looks like:</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">it</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;should render forks and joins&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  imgSnapshotTest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    \`</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    stateDiagram</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    state fork_state &amp;lt;&amp;lt;fork&amp;gt;&amp;gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      [*] --&gt; fork_state</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      fork_state --&gt; State2</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      fork_state --&gt; State3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      state join_state &amp;lt;&amp;lt;join&amp;gt;&amp;gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      State2 --&gt; join_state</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      State3 --&gt; join_state</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      join_state --&gt; State4</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      State4 --&gt; [*]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    \`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { logLevel: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="update-documentation" tabindex="-1">Update Documentation <a class="header-anchor" href="#update-documentation" aria-label="Permalink to &quot;Update Documentation&quot;">​</a></h3><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Our documentation is managed in <code>packages/mermaid/src/docs</code>. Details on how to edit is in the <a href="#contributing-documentation">documentation section</a></p></div><p>If the users have no way to know that things have changed, then you haven&#39;t really <em>fixed</em> anything for the users; you&#39;ve just added to making Mermaid feel broken. Likewise, if users don&#39;t know that there is a new feature that you&#39;ve implemented, it will forever remain unknown and unused.</p><p>The documentation has to be updated for users to know that things have been changed and added! If you are adding a new feature, add <code>(v&lt;MERMAID_RELEASE_VERSION&gt;+)</code> in the title or description. It will be replaced automatically with the current version number when the release happens.</p><p>eg: <code># Feature Name (v&lt;MERMAID_RELEASE_VERSION&gt;+)</code></p><p>We know it can sometimes be hard to code <em>and</em> write user documentation.</p><p>Create another issue specifically for the documentation. You will need to help with the PR, but definitely ask for help if you feel stuck. When it feels hard to write stuff out, explaining it to someone and having that person ask you clarifying questions can often be 80% of the work!</p><p>When in doubt, write up and submit what you can. It can be clarified and refined later. (With documentation, something is better than nothing!)</p><h2 id="contributing-documentation" tabindex="-1">Contributing Documentation <a class="header-anchor" href="#contributing-documentation" aria-label="Permalink to &quot;Contributing Documentation&quot;">​</a></h2><p>If it is not in the documentation, it&#39;s like it never happened. Wouldn&#39;t that be sad? With all the effort that was put into the feature?</p><h3 id="where-is-the-documentation-located" tabindex="-1">Where is the Documentation Located? <a class="header-anchor" href="#where-is-the-documentation-located" aria-label="Permalink to &quot;Where is the Documentation Located?&quot;">​</a></h3><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>DO NOT CHANGE FILES IN <code>/docs</code></p><p>The <code>docs</code> folder will be automatically generated when committing to <code>packages/mermaid/src/docs</code> and <strong>should not</strong> be edited manually.</p></div><p>Documentation is located in the <a href="https://github.com/mermaid-js/mermaid/tree/develop/packages/mermaid/src/docs" target="_blank" rel="noreferrer"><code>packages/mermaid/src/docs</code></a> folder. Just pick the right section and start typing.</p><p>The contents of <a href="https://mermaid.js.org/" target="_blank" rel="noreferrer">mermaid.js.org</a> are based on the docs from the <code>master</code> branch. Updates committed to the <code>master</code> branch are reflected in the <a href="https://mermaid.js.org/" target="_blank" rel="noreferrer">Mermaid Docs</a> once published.</p>`,75)),(i(),o(r,null,{default:t(()=>[l(n,{id:"mermaid-461",showCode:!0,graph:"flowchart%20LR%0A%20%20classDef%20default%20fill%3A%23fff%2Ccolor%3Ablack%2Cstroke%3Ablack%0A%0A%20%20source%5B%22Edit%20%2Fpackages%2Fmermaid%2Fsrc%2Fdocs%22%5D%20--%20automatic%20processing--%3E%20published%5B%22View%20%2Fdocs%20which%20will%20be%20published%20on%20Official%20Website%22%5D%0A"})]),fallback:t(()=>[...e[4]||(e[4]=[a(" Loading... ",-1)])]),_:1})),e[15]||(e[15]=h('<h3 id="running-the-documentation-website-locally" tabindex="-1">Running the Documentation Website Locally <a class="header-anchor" href="#running-the-documentation-website-locally" aria-label="Permalink to &quot;Running the Documentation Website Locally&quot;">​</a></h3><p><strong><a href="https://mermaid.js.org/" target="_blank" rel="noreferrer">The mermaid documentation site</a> is powered by <a href="https://vitepress.vuejs.org/" target="_blank" rel="noreferrer">Vitepress</a>.</strong></p><p>Start development server for the documentation site</p><p><strong>Host</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --filter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mermaid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docs:dev</span></span></code></pre></div><p>or</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packages/mermaid</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docs:dev</span></span></code></pre></div><p><strong>Docker</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docs:dev</span></span></code></pre></div><p>Open <a href="http://localhost:3333/" target="_blank" rel="noreferrer">http://localhost:3333/</a> in your browser.</p><h3 id="formatting" tabindex="-1">Formatting <a class="header-anchor" href="#formatting" aria-label="Permalink to &quot;Formatting&quot;">​</a></h3><p>The documentation is written in Markdown. To get acquainted with its syntax <a href="https://help.github.com/en/github/writing-on-github/basic-writing-and-formatting-syntax" target="_blank" rel="noreferrer">see the GitHub Markdown help page</a>.</p><p>You can use <code>note</code>, <code>tip</code>, <code>warning</code> and <code>danger</code> in triple backticks to add a note, tip, warning or danger box.</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>Do not use vitepress specific markdown syntax <code>::: warning</code> as it will not be processed correctly.</p></div><p>Here are a few examples:</p><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">```note</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">This is a note</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">```</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">```tip</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">This is a tip</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">```</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">```warning</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">This is a warning</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">```</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">```danger</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">This is a danger alert</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">```</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This is a note</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>This is a tip</p></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>This is a warning</p></div><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>This is a danger alert</p></div><h3 id="navigation" tabindex="-1">Navigation <a class="header-anchor" href="#navigation" aria-label="Permalink to &quot;Navigation&quot;">​</a></h3><p>If you want to propose changes to how the documentation is <em>organized</em>, such as adding a new section or re-arranging or renaming a section, you must update the <strong>sidebar navigation</strong>, which is defined in <a href="../.vitepress/config.ts">the vitepress config</a>. The same goes for <strong>topbar</strong>.</p><h3 id="build-docs" tabindex="-1">Build Docs <a class="header-anchor" href="#build-docs" aria-label="Permalink to &quot;Build Docs&quot;">​</a></h3><p>The content of <code>/docs</code> folder is built with GitHub Actions.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>So as to allow automatic compilation of documentation pages you have to enable GitHub Actions on your fork first</p></div><h2 id="submit-your-pull-request" tabindex="-1">Submit your pull request <a class="header-anchor" href="#submit-your-pull-request" aria-label="Permalink to &quot;Submit your pull request&quot;">​</a></h2><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Do not forget to push your changes</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docs/2910_update-guidelines</span></span></code></pre></div></div><p>We make all changes via Pull Requests (PRs). Open a new one.</p><p>Right now we are not following any strict rules about naming PRs. Give it a representative title and short description. There is also a <a href="https://github.com/mermaid-js/mermaid/blob/develop/.github/pull_request_template.md" target="_blank" rel="noreferrer">pull request template</a> which will help you with it.</p><p>In case in its description contains a <a href="https://docs.github.com/en/issues/tracking-your-work-with-issues/linking-a-pull-request-to-an-issue" target="_blank" rel="noreferrer">magic comment</a> your PR will be automatically attached to the issue:</p><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Resolves #&lt;your issue ID here&gt;</span></span></code></pre></div><h2 id="congratulations" tabindex="-1">Congratulations <a class="header-anchor" href="#congratulations" aria-label="Permalink to &quot;Congratulations&quot;">​</a></h2><p>You have successfully submitted your improvements! What is next?</p><ul><li>PRs will be reviewed by active maintainers, who will provide feedback and request changes as needed.</li><li>The maintainers will request a review from <em>knsv</em>, if necessary.</li><li>Once the PR is approved, the maintainers will merge the PR into the <code>develop</code> branch.</li><li>When a release is ready, the <code>release/x.x.x</code> branch will be created, extensively tested and knsv will be in charge of the release process.</li></ul><p>Thanks for you help!</p>',35))])}const E=p(k,[["render",g]]);export{F as __pageData,E as default};
